
[Seurat](https://satijalab.org/seurat) is an famous R toolkit for single cell genomics. Our program provides an interface for Seurat users. 

## Use Seurat object as input
If now you have a `SeuratObject`, then you can export raw counts into `.csv` file from SeuratObject:
```R
write.table(as.matrix(GetAssayData(object = yourSeuratObject, slot = "counts")), 
        '~/counts.csv', 
        sep = ',', row.names = T, col.names = T, quote = F)
```
Then run scGNN2.0 project from this csv file:
```bash
python scGNN_v2.py --load_seurat_object ~/counts.csv \
    --output_dir your_output_dir
```

## Load from Rdata
To run scGNN2.0 project from a `Rdata` file:
```bash
python scGNN_v2.py --load_rdata ~/data.Rdata \
    --output_dir your_output_dir
```

## Output in Rdata format
To generate results in `Rdata` format, you need to specify `output_rdata`:
```bash
python scGNN_v2.py --load_rdata ~/counts.Rdata \
    --output_dir your_output_dir --output_rdata
```

## Visualization
You can also load the cell embeddings generated by scGNN2.0 and visualize it in Seurat:
```R
embeddings=read.csv(file =your_embedding_path ,header=TRUE,row.names = 1)
pbmc[["pca"]] <- CreateDimReducObject(embeddings = as.matrix(embeddings), key = "embedding_", assay = DefaultAssay(pbmc))
pbmc <- RunUMAP(pbmc, dims = 1:128)
DimPlot(pbmc, reduction = "umap")
```

## Load data from 10X format
scGNN2.0 supports loading 10X format data as input, you need to specify a directory that contains `mtx` data:
```bash
python scGNN_v2.py --load_from_10X your_10X_dir \
    --output_dir your_output_dir
```